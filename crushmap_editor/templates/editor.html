<!-- kate: space-indent on; indent-width 4; replace-tabs on; -->
<div class="container-fluid">
    <div class="row" ng-show="!clusters.$resolved">
        Loading...
    </div>
    <div class="row" ng-show="clusters.$resolved && clusters.length === 0">
        No Ceph clusters available.
    </div>
    <div class="row" ng-show="clusters.$resolved && clusters.length > 0">
        <article class="col-sm-12 col-md-12 col-lg-6">
            <div class="jarviswidget" id="wid-id-1" data-widget-editbutton="false" data-widget-custombutton="false">
                <header>
                    <div class="widget-toolbar" role="menu">
                        <a class="dropdown-toggle" ng-click="query()"><i class="fa fa-refresh"></i> Refresh </a>
                    </div>
                    <span class="widget-icon"> <i class="fa fa-edit"></i> </span>
                    <h2>CRUSH Map for Cluster &ldquo;{{cluster.name}}&rdquo;</h2>
                </header>
                <div class="tree">
                    <ul>
                        <li><span ng-bind="cluster.name"></span></li>
                        <ul>
                            <li ng-repeat="data in cluster.crush_map" ng-include="'extensions/crushmap_editor/templates/crushMapNode.html'"></li>
                        </ul>
                    </ul>
                </div>
            </div>
        </article>
        <article class="col-sm-12 col-md-12 col-lg-6">
            <div class="jarviswidget" id="wid-id-1" data-widget-editbutton="false" data-widget-custombutton="false">
                <header>
                    <span class="widget-icon"> <i class="fa fa-edit"></i> </span>
                    <h2>Ruleset editor</h2>
                </header>
                <div>
                    <form name="hostForm" role="form" class="form-horizontal" novalidate>
                        <fieldset>
                            <div class="form-group">
                                <label class="col-md-2 control-label" for="ruleset">Contents</label>
                                <div class="col-md-10">
                                    <select class="form-control"
                                        ng-options="ruleset as ruleset.name for ruleset in cluster.rulesets track by ruleset.id"
                                        ng-model="activeRuleset">
                                        <option value="">Select a ruleset...</option>
                                    </select>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset ng-show="activeRuleset">
                            <div class="form-group">
                                <label class="col-md-2 control-label" for="replicas">Replicas</label>
                                <div class="col-md-10">
                                    <span>
                                        <p>Choose the number of replicas for which you would like to simulate data placement.</p>
                                    </span>
                                    <div class="row">
                                        <div class="col-md-6">
                                            <input type="number" class="form-control" ng-model="activeRuleset.min_size" />
                                        </div>
                                        <div class="col-md-6">
                                            <input type="number" class="form-control" ng-model="activeRuleset.max_size" />
                                        </div>
                                    </div>
                                    <span ng-show="activeRuleset.min_size === 1">
                                        <p class="text-danger">1 replica means <em>no copies</em>. If you lose the original, your data is lost.</p>
                                    </span>
                                    <span ng-show="activeRuleset.min_size > 1">
                                        <p ng-class="{ 'text-warning': activeRuleset.min_size == 2, 'text-muted': activeRuleset.min_size > 2 }">
                                            {{ activeRuleset.min_size }} replicas means "the original file + {{ activeRuleset.min_size - 1 }}
                                            <ng-pluralize count="activeRuleset.min_size - 1" when="{1: 'copy', 'other': 'copies'}"></ng-pluralize>".
                                        </p>
                                    </span>
                                </div>
                            </div>
                        </fieldset>
                        <fieldset ng-show="activeRuleset">
                            <div class="form-group">
                                <label class="col-md-2 control-label" for="steps">Steps</label>
                                <div class="col-md-10">
                                    <ol>
                                        <li ng-repeat="step in activeRuleset.steps">
                                            <span ng-show="step.op === 'take'">
                                                Start at {{ step.item_name }}
                                            </span>
                                            <span ng-show="step.op === 'choose_firstn' || step.op === 'chooseleaf_firstn'">
                                                Choose <span ng-show="step.op === 'chooseleaf_firstn'">one OSD from each of </span>
                                                <ng-pluralize count="getRealNum(step)" when="{
                                                    '1': 'one ' + step.type,
                                                    'other': '{} ' + step.type + 's'
                                                }"></ng-pluralize>
                                                <span ng-show="step.num < 0">({{ repsize }} - {{ -step.num}})</span>
                                            </span>
                                            <span ng-show="step.op === 'emit'">Add these OSDs to the list</span>
                                        </li>
                                    </ol>
                                </div>
                            </div>
                        </fieldset>
                    </form>
                </div>
            </div>
        </article>
    </div>
</div>
