{% load i18n %}
{% comment %}
 Copyright (C) 2011-2012, it-novum GmbH <community@open-attic.org>

 openATTIC is free software; you can redistribute it and/or modify it
 under the terms of the GNU General Public License as published by
 the Free Software Foundation; version 2.

 This package is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU General Public License for more details.
{% endcomment %}
<html>
  <head>
    <title>openATTIC</title>
    <link rel="shortcut icon" href="{{ MEDIA_URL }}/openattic_favicon.png" type="image/png" />
    <link rel="stylesheet" href="{{ MEDIA_URL }}/extjs/resources/css/ext-all.css" />
    {% if THEME %}
      <link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}/extjs_themes/css/xtheme-{{ THEME }}.css" />
    {% endif %}
    <!--[if IE]><script type="text/javascript" src="{{ MEDIA_URL }}/canvasxpress/excanvas.js"></script><![endif]-->
    <script type="text/javascript" src="{{ MEDIA_URL }}/canvasxpress/canvasXpress.min.js"></script>
    <script src="{{ MEDIA_URL }}/extjs/adapter/ext/ext-base.js"></script>
    <script src="{{ MEDIA_URL }}/extjs/ext-all-debug.js"></script>
    {% if LANGUAGE_CODE %}
      <script src="{{ MEDIA_URL }}/extjs_languages/ext-lang-{{ LANGUAGE_CODE }}.js"></script>
    {% endif %}
    <script type="text/javascript" src="{{ MEDIA_URL }}/canvasxpress/ext-canvasXpress.js"></script>
    <script src="{% url django.views.i18n.javascript_catalog %}"></script>
    <script src="{{ PROJECT_URL }}/userprefs/initprefs.js"></script>
    <script src="{{ PROJECT_URL }}/direct/api.js"></script>
    <script type="text/javascript">
      window.MainViewModules = [];
      window.SnapAppPlugins = [];
      window.HostAttrPlugins = [];
      Ext.namespace("Ext.ux");
      window.MEDIA_URL   = '{{ MEDIA_URL  }}';
      window.PROJECT_URL = '{{ PROJECT_URL  }}';
      window.LOGOUT_URL  = '{% url logout %}';
      window.INDEX_URL   = '{% url index  %}';
      window.HOSTNAME    = '{{ LOCALHOST.name }}';
      Ext.BLANK_IMAGE_URL = MEDIA_URL + "/extjs_themes/images/gray/s.gif";
      Ext.namespace("Ext.oa");
      Ext.oa.renderBoolean = function (val, x, store){
        if (val)
          return '<img src="{{ MEDIA_URL }}/oxygen/16x16/actions/dialog-ok-apply.png" title="yes" />';
        return '<img src="{{ MEDIA_URL }}/oxygen/16x16/actions/dialog-cancel.png" title="no" />';
      };
      // Hack to fix setReadOnly not being available before Ext 3.2.x
      if( typeof Ext.form.TextField.prototype.setReadOnly === "undefined" ){
        Ext.form.TextField.prototype.setReadOnly = function(readOnly){
          if(this.rendered){
            this.el.dom.readOnly = readOnly;
          }
          this.readOnly = readOnly;
        }
      }
      function toUnicode(val){
        "use strict";
        if(val){
          return val.__unicode__;
        }
        return '';
      }
      function get_format_ext(format_type){
        // Translate the Django datetime format extensions into stuff that ExtJS actually understands.
        var fmt = get_format(format_type),
            res = "",
            esc = false;
        for( var i = 0; i < fmt.length; i++ ){
          if(esc){
            res += fmt[i];
            esc = false;
          }
          else if(fmt[i] === '\\'){
            esc = true;
          }
          else{
            res += ({
              b: 'M',
              e: 'T',
              E: 'F',
              f: 'g:i',
              N: 'M',
              P: 'g:i a',
              r: 'D, m M Y H:i:s O'
            }[fmt[i]] || fmt[i]);
          }
        }
        return res;
      }
    </script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/portal/Portal.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/portal/PortalColumn.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/portal/Portlet.js"></script>
    <script src="{{ MEDIA_URL }}/js/directstateprovider.js"></script>
    <script src="{{ MEDIA_URL }}/js/tipify.js"></script>
    <script src="{{ MEDIA_URL }}/js/dangerousmessage.js"></script>
    <script type="text/javascript">
      Ext.Ajax.on("requestcomplete", function( provider, response, opt ){
        var respdata  = Ext.decode( response.responseText );
        if( respdata.type === "exception" ){
          if( respdata.message === "Access Denied!" ){
            Ext.oa.RedDangerousMessage.alert("Session expired",
              "It seems your session has expired. The page will now be reloaded so you can login again.",
              function(){
                window.location.reload();
              }
            );
          }
          else if( respdata.where ){
            Ext.Msg.alert("Error: " + respdata.message, "<pre>" + respdata.where + "</pre>");
          }
        }
      });
    </script>
    <script src="{% url javascript_main 'recorder' %}"></script>
    <script src="{% url javascript_main 'sharegridpanel' %}"></script>
    <script src="{% url javascript_main 'menutree' %}"></script>
    <script src="{% url javascript_main 'settings' %}"></script>
    <script src="{% url javascript_main 'logout' %}"></script>

    <script src="{{ MEDIA_URL }}/js/Reorderer.js"></script>
    <script src="{{ MEDIA_URL }}/js/ToolbarReorderer.js"></script>
    <script src="{{ MEDIA_URL }}/js/ToolbarDroppable.js"></script>
    {% for apptemplate in INSTALLED_APP_TEMPLATES %}
      {% include apptemplate %}
    {% endfor %}
    <script src="{{ MEDIA_URL }}/js/portlets.js"></script>
    <script src="{{ MEDIA_URL }}/js/portal.js"></script>
    <script src="{{ MEDIA_URL }}/js/mainviewmanager.js"></script>
    <script>
      Ext.onReady( function(){
        Ext.QuickTips.init();

        mainpanel = new Ext.oa.MainViewManager({
          renderTo: document.body,
          toolbarMessages: {
            title: "Delete Button?",
            message: "{% trans 'Do you really wish to remove this button from the toolbar?' %}"
        }});
        function updateLayout(){
          viewsize = {
            width:  Ext.lib.Dom.getViewWidth(),
            height: Ext.lib.Dom.getViewHeight()
          };
          mainpanel.setHeight( viewsize.height - 20 );
          mainpanel.setWidth(  viewsize.width  - 40 );
        }
        updateLayout();
        Ext.EventManager.onWindowResize(updateLayout);
      });
    </script>
    <style>
      {% if THEME == "access" %}
        .x-tab-panel-body {
          /* For some reason, the author of xtheme-access set this to white which looks stupid */
          background-color: #1F2730;
          border-color: #18181A;
          color: #FFFFF6;
        }
        .x-grid3-row-over .x-grid3-row-table {
          text-decoration: none;
          background-color:#454657 !important;
        }
        div.nagiosportlet div.x-box-inner {
          background-color: #1F2730;
        }
      {% else %}
        div.nagiosportlet div.x-box-inner {
          background-color: #FFFFFF;
        }
      {% endif %}
      div.munin-graphs { /* Siehe imagespanel.cls */
        padding-top: 10px;
        text-align: center;
        background-color: transparent;
      }
      div.thumb-wrap {
        text-align: center;
        font-size: 14px;
      }
      .x-tree-node-icon {
        height: 22px !important;
        width:  22px !important;
      }
      .redmask {
        background-color: #FF0000;
      }
      .yellowmask {
        background-color: #FFFF00;
      }
      .mainviewtoolbar .x-btn-text {
        height: 45px !important;
      }
      img.atticlogo {
        cursor: pointer;
        padding-left: 10px;
        padding-right: 10px;
      }
      div.lv_used_crit .x-progress-bar {
        background-image: url("{{ MEDIA_URL }}/progress_crit.gif");
        border-bottom-color: #993333;
        border-right-color: #2b3333;
        border-top-color: #2b3300;
      }
      div.lv_used_warn .x-progress-bar {
        background-image: url("{{ MEDIA_URL }}/progress_warn.gif");
        border-bottom-color: #A66900;
        border-right-color: #FFB941;
        border-top-color: #A66900;
      }
      div.lv_used_ok .x-progress-bar {
        background-image: url("{{ MEDIA_URL }}/progress_ok.gif");
        border-bottom-color: #332b33;
        border-right-color: #332b33;
        border-top-color: #332b00;
      }
      .form_hint_label {
        font-family:    Lucida Grande,Verdana,Arial,sans-serif;
        font-size:      10px;
        font-weight:    400;
        font-style:     normal;
        color:          #999999;
        margin-left:    110px;
      }
      {% if THEME == "access" %}
      .x-progress-wrap {
         background-color:#232D38;
      }
      {% endif %}
    </style>
  </head>
  <body style="padding: 20px 20px 0; ">
    <noscript>Please enable JavaScript to view openATTIC.</noscript>
  </body>
  <!-- kate: space-indent on; indent-width 2; replace-tabs on; -->
  <!-- vim:set shiftwidth=2 softtabstop=2 expandtab: -->
</html>
