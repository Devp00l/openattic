<div class="col-sm-12 col-lg-6">

  <div class="panel panel-default" ng-show="$ctrl.error">
    <div class="panel-heading">
      <h3 class="panel-title">Couldn't load settings</h3>
    </div>
    <div class="panel-body">
      Setting could not be loaded.
    </div>
  </div>

  <oa-loading-panel message="Settings are loading..."
                    ng-show="!$ctrl.error && !$ctrl.model.$resolved"></oa-loading-panel>

  <form ng-show="!$ctrl.error && $ctrl.model.$resolved" name="settingsForm" role="form" class="form-horizontal"
        novalidate oa-check-form>
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Settings</h3>
      </div>
      <div class="panel-body">

        <legend>Salt API</legend>

        <!-- Salt API Host -->
        <div class="form-group"
             ng-class="{'has-error': (settingsForm.$submitted || settingsForm['saltApiHost'].$dirty) && settingsForm['saltApiHost'].$invalid}">
          <label class="col-sm-3 control-label" for="saltApiHost">Host</label>
          <div class="col-sm-9">
            <input type="text" class="form-control" name="saltApiHost" id="saltApiHost"
                   ng-model="$ctrl.model.deepsea.host" ng-change="$ctrl.checkDeepSeaConnection()" required>
            <span class="help-block"
                  ng-show="settingsForm.$submitted || settingsForm['saltApiHost'].$dirty">
              <span class="tc_saltApiHostRequired"
                    ng-show="settingsForm['saltApiHost'].$error.required">Required field</span>
            </span>
          </div>
        </div>

        <!-- Salt API Port -->
        <div class="form-group"
             ng-class="{'has-error': (settingsForm.$submitted || settingsForm['saltApiPort'].$dirty) && settingsForm['saltApiPort'].$invalid}">
          <label class="col-sm-3 control-label" for="saltApiPort">Port</label>
          <div class="col-sm-9">
            <input type="number" class="form-control" name="saltApiPort" id="saltApiPort"
                   ng-model="$ctrl.model.deepsea.port" ng-change="$ctrl.checkDeepSeaConnection()" required>
            <span class="help-block"
                  ng-show="settingsForm.$submitted || settingsForm['saltApiPort'].$dirty">
              <span class="tc_saltApiPortRequired"
                    ng-show="settingsForm['saltApiPort'].$error.required">Required field</span>
            </span>
          </div>
        </div>

        <!-- Salt API Eauth -->
        <div class="form-group"
             ng-class="{'has-error': (settingsForm.$submitted || settingsForm['saltApiEauth'].$dirty) && settingsForm['saltApiEauth'].$invalid}">
          <label class="col-sm-3 control-label" for="saltApiEauth">Eauth</label>
          <div class="col-sm-9">
            <select class="form-control"
                    ng-model="$ctrl.model.deepsea.eauth"
                    ng-options="eauth for eauth in ['auto']"
                    name="saltApiEauth"
                    id="saltApiEauth"
                    ng-change="$ctrl.checkDeepSeaConnection()"
                    required>
              <option value="">-- Select the eauth --</option>
            </select>
            <span class="help-block"
                  ng-show="settingsForm.$submitted || settingsForm['saltApiEauth'].$dirty">
              <span class="tc_saltApiEauthRequired"
                    ng-show="settingsForm['saltApiEauth'].$error.required">Required field</span>
            </span>
          </div>
        </div>

        <!-- Salt API Username -->
        <div class="form-group"
             ng-class="{'has-error': (settingsForm.$submitted || settingsForm['saltApiUsername'].$dirty) && settingsForm['saltApiUsername'].$invalid}"
             ng-if="$ctrl.model.deepsea.eauth === 'auto'">
          <label class="col-sm-3 control-label" for="saltApiUsername">Username</label>
          <div class="col-sm-9">
            <input type="text" class="form-control" name="saltApiUsername" id="saltApiUsername"
                   ng-model="$ctrl.model.deepsea.username" ng-change="$ctrl.checkDeepSeaConnection()" required>
            <span class="help-block"
                  ng-show="settingsForm.$submitted || settingsForm['saltApiUsername'].$dirty">
              <span class="tc_saltApiUsernameRequired"
                    ng-show="settingsForm['saltApiUsername'].$error.required">Required field</span>
            </span>
          </div>
        </div>

        <div class="pull-right">
          <span ng-if="$ctrl.deepseaConnectionStatus.loading"><i class="fa fa-spinner fa-spin fa-fw" aria-hidden="true"></i> Checking connection</span>
          <span class="text-success tc_deepseaConnectionSuccess" ng-show="$ctrl.deepseaConnectionStatus.success === true"><i class="fa fa-check" aria-hidden="true"></i> Salt API connection successfull</span>
          <span class="text-danger tc_deepseaConnectionFail" ng-show="$ctrl.deepseaConnectionStatus.success === false"><i class="fa fa-times" aria-hidden="true"></i> Salt API connection failed</span>
        </div>
        <br>
        <div class="pull-right">
          <span class="text-muted" ng-if="$ctrl.deepseaConnectionStatus.message">
            {{ $ctrl.deepseaConnectionStatus.message }} - <a ng-click="$ctrl.checkDeepSeaConnection()">retry</a>
          </span>
          <span ng-if="!$ctrl.deepseaConnectionStatus.message">&nbsp;</span>
        </div>

        <legend>Object Gateway</legend>

        <!-- Object Gateway Managed by DeepSea -->
        <div class="form-group">
          <div class="col-sm-offset-3 col-sm-9">
            <div class="checkbox checkbox-primary">
              <input type="checkbox" ng-model="$ctrl.model.rgw.managed_by_deepsea" name="active"
                     id="rgwManagedByDeepSea" ng-change="$ctrl.rgwManagedByDeepSeaChangeHandler()">
              <label for="rgwManagedByDeepSea">
                Managed by DeepSea
              </label>
            </div>
          </div>
        </div>

        <!-- Object Gateway Host -->
        <div class="form-group">
          <label class="col-sm-3 control-label" for="rgwApiHost">Host</label>
          <div class="col-sm-9">
            <input type="text" class="form-control" name="rgwApiHost" id="rgwApiHost"
                   ng-model="$ctrl.model.rgw.host" ng-change="$ctrl.checkRgwConnection()"
                   ng-disabled="$ctrl.model.rgw.managed_by_deepsea">
          </div>
        </div>

        <!-- Object Gateway Port -->
        <div class="form-group">
          <label class="col-sm-3 control-label" for="rgwApiPort">Port</label>
          <div class="col-sm-9">
            <input type="text" class="form-control" name="rgwApiPort" id="rgwApiPort"
                   ng-model="$ctrl.model.rgw.port" ng-change="$ctrl.checkRgwConnection()"
                   ng-disabled="$ctrl.model.rgw.managed_by_deepsea">
          </div>
        </div>

        <!-- Object Gateway Access Key -->
        <div class="form-group">
          <label class="col-sm-3 control-label" for="rgwApiAccessKey">Access Key</label>
          <div class="col-sm-9">
            <input type="text" class="form-control" name="rgwApiAccessKey" id="rgwApiAccessKey"
                   ng-model="$ctrl.model.rgw.access_key" ng-change="$ctrl.checkRgwConnection()"
                   ng-disabled="$ctrl.model.rgw.managed_by_deepsea">
          </div>
        </div>

        <!-- Object Gateway Secret Key -->
        <div class="form-group">
          <label class="col-sm-3 control-label" for="rgwApiSecretKey">Secret Key</label>
          <div class="col-sm-9">
            <input type="text" class="form-control" name="rgwApiSecretKey" id="rgwApiSecretKey"
                   ng-model="$ctrl.model.rgw.secret_key" ng-change="$ctrl.checkRgwConnection()"
                   ng-disabled="$ctrl.model.rgw.managed_by_deepsea">
          </div>
        </div>

        <!-- Object Gateway Admin User -->
        <div class="form-group">
          <label class="col-sm-3 control-label" for="rgwApiAdminUser">Admin User</label>
          <div class="col-sm-9">
            <input type="text" class="form-control" name="rgwApiAdminUser" id="rgwApiAdminUser"
                   ng-model="$ctrl.model.rgw.user_id" ng-change="$ctrl.checkRgwConnection()"
                   ng-disabled="$ctrl.model.rgw.managed_by_deepsea">
          </div>
        </div>

        <!-- Object Use SSL -->
        <div class="form-group">
          <div class="col-sm-offset-3 col-sm-9">
            <div class="checkbox checkbox-primary">
              <input type="checkbox" ng-model="$ctrl.model.rgw.use_ssl" name="active"
                     id="rgwUseSSL" ng-change="$ctrl.checkRgwConnection()"
                     ng-disabled="$ctrl.model.rgw.managed_by_deepsea">
              <label for="rgwUseSSL">
                Use SSL
              </label>
            </div>
          </div>
        </div>

        <div class="pull-right">
          <span ng-if="$ctrl.rgwConnectionStatus.loading"><i class="fa fa-spinner fa-spin fa-fw" aria-hidden="true"></i> Checking connection</span>
          <span class="text-success tc_rgwConnectionSuccess" ng-show="$ctrl.rgwConnectionStatus.success === true"><i class="fa fa-check" aria-hidden="true"></i> Object Gateway API connection successfull</span>
          <span class="text-danger tc_rgwConnectionFail" ng-show="$ctrl.rgwConnectionStatus.success === false"><i class="fa fa-times" aria-hidden="true"></i> Object Gateway API connection failed</span>
        </div>
        <br>
        <div class="pull-right">
          <span class="text-muted" ng-if="$ctrl.rgwConnectionStatus.message">
            {{ $ctrl.rgwConnectionStatus.message }} - <a ng-click="$ctrl.checkRgwConnection()">retry</a>
          </span>
          <span ng-if="!$ctrl.rgwConnectionStatus.message">&nbsp;</span>
        </div>

      </div>

      <div class="panel-footer">
        <div class="button-group text-right">
          <button type="submit" class="btn btn-sm btn-primary tc_submitButton"
                  ng-disabled="settingsForm.$invalid || settingsForm.$submitted"
                  ng-click="$ctrl.saveAction()">
            Save
            <i class="fa fa-spinner fa-spin fa-fw" ng-if="settingsForm.$submitted"></i>
          </button>
        </div>
      </div>
    </div>
  </form>
</div>
