<div class="col-sm-12 col-lg-6">
    <form name="rbdForm" role="form" class="form-horizontal" novalidate>
        <div class="panel panel-default">
            <div class="panel-heading tc_formHeadline">
                <h3 class="panel-title">Create RBD: {{rbd.name}}</h3>
            </div>
            <div class="panel-body">
                <uib-accordion>
                    <uib-accordion-group is-open="accordionOpen.properties">
                        <uib-accordion-heading>
                            RBD Properties
                            <i class="pull-right" ng-class="{'fa fa-angle-up': accordionOpen.properties,
                            'fa fa-angle-down': !accordionOpen.properties}"></i>
                        </uib-accordion-heading>
<div class="form-group" ng-class="{'has-error': (rbdForm.$submitted || rbdForm.name.$dirty)
    && rbdForm.name.$invalid}">
    <label ng-class="wizard ? 'col-md-2' : 'col-sm-3'" class="control-label" for="rbdName">Name</label>
    <div ng-class="wizard ? 'col-md-10' : 'col-sm-9'">
        <input type="text" class="form-control tc_rbd_name" placeholder="Name..."
            ng-model="rbd.name" name="name" validname uniquename="rbd" required autofocus>
        <span class="help-block tc_nameRequired" ng-show="(rbdForm.$submitted || rbdForm.name.$dirty)
            && rbdForm.name.$error.required">This field is required!</span>
        <span class="help-block tc_noValidName" ng-show="rbdForm.name.$error.validname">{{errortext}}</span>
        <span class="help-block tc_noUniqueName" ng-show="rbdForm.name.$error.uniquename">
            The chosen RBD name is already in use.
        </span>
    </div>
</div>

<div class="form-group" ng-class="{'has-error': (rbdForm.$submitted || rbdForm.pool.$dirty)
    && rbdForm.pool.$invalid}">
    <label ng-class="wizard ? 'col-md-2' : 'col-sm-3'" class="control-label" for="pool">Pool</label>
    <div ng-class="wizard ? 'col-md-10' : 'col-sm-9'">
        <select ng-hide="pools" ng-disabled="!pools" class="form-control form-control-static">
            <option>Retrieving pool list...</option>
        </select>
        <select ng-show="pools" class="form-control tc_pool_selection tc_source_pool" ng-model="data.pool"
                ng-options="(pool.name + ' (' + pool.oaFreeText + ' free)' ) for pool in pools track by pool.id" name="pool" required>
            <option class="tc_rbdPoolOption" value="">-- Select a pool --</option>
        </select>
        <div ng-show="data.pool" class="progress-bar-outer clearfix">
            <uib-progressbar max="100" class="progress-striped" value="data.pool.oaUsed">
                <span></span>
            </uib-progressbar>
                <span class="pull-left tc_poolSize">{{data.pool.num_bytes | bytes}} of {{data.pool.oaFreeText}} used</span>
                <span class="pull-right tc_poolAvailableSize">
                    {{data.pool.oaFreeText}} free - <a ng-click="data.size = data.pool.oaFree">use max</a>
                </span>
        </div>
        <span class="help-block tc_sizeRequired" ng-show="(rbdForm.$submitted || rbdForm.pool.$dirty)
            && rbdForm.pool.$error.required">
            This field is required!
        </span>
        <span class="help-block" ng-bind="data.pool.num_bytes | bytes">
        </span>
    </div>
</div>

<div class="form-group" ng-class="{'has-error': (rbdForm.$submitted || rbdForm.size.$dirty)
    && rbdForm.size.$invalid}">
    <label ng-class="wizard ? 'col-md-2' : 'col-sm-3'" class="control-label" for="rbd.size">Size</label>
    <div ng-class="wizard ? 'col-md-10' : 'col-sm-9'">
        <input class="form-control tc_rbd_size" type="text" name="size"
            ng-disabled="data.pool == null" max-ng-value="data.pool.oaFree"
            ng-model="data.size" placeholder="e.g., 10GB" required>
        <span class="help-block tc_sizeRequired" ng-show="(rbdForm.$submitted || rbdForm.size.$dirty)
            && rbdForm.size.$error.required">
            This field is required!
        </span>
    </div>
</div>

                    </uib-accordion-group>
                    <uib-accordion-group is-open="accordionOpen.expert">
                        <uib-accordion-heading>
                            RBD Experts
                            <i class="pull-right" ng-class="{'fa fa-angle-up': accordionOpen.properties,
                            'fa fa-angle-down': !accordionOpen.properties}"></i>
                        </uib-accordion-heading>
<div class="form-group">
    <div ng-class="wizard ? 'col-sm-offset-2 col-sm-10' : 'col-sm-offset-3 col-sm-9'">
        <div class="checkbox checkbox-primary">
            <input type="checkbox" ng-model="data.expert" class="tc_rbd_is_expert" ng-name="expert">
            <label for="data.expert" ng-click="data.expert = !data.expert"><b>Use expert settings</b></label>
        </div>
    </div>
</div>
<div class="form-group">
    <div ng-class="wizard ? 'col-sm-offset-2 col-sm-10' : 'col-sm-offset-3 col-sm-9'">
        <div class="checkbox checkbox-primary" ng-repeat="(key, feature) in features" >
            <input type="checkbox" ng-model="data.features[key]" ng-disabled="key == 'striping' && data.features.layering || key == 'layering' && data.features.striping" class="tc_rbd_is_{{key}}" ng-name="key">
            <label for="data.features[key]" ng-click="data.features[key] = !data.features[key]" ng-bind="feature.desc"></label>
        </div>
    </div>
</div>
                    </uib-accordion-group>
                </uib-accordion>
            </div>
            <div class="panel-footer">
                <div class="button-group text-right">
                    <button type="submit" class="btn btn-sm btn-primary tc_submitButton"
                            ng-click="submitAction(rbdForm)">
                        Submit
                    </button>
                    <button type="button" class="btn btn-sm btn-default tc_backButton" ng-click="cancelAction()">
                        Back
                    </button>
                </div>
            </div>
        </div>
    </form>
</div>
